---
# Front matter
lang: ru-RU
title: Молекулярная динамика
subtitle: Этап 2
author: |
	Асеинова Е.В.;
    Бармина О.К.;
	Горбунова Я.М.;
	Евсеева Д.О.;
	Исаханян Э.Т.
group: NFIbd-01-19
institute: RUDN University, Moscow, Russian Federation
date: 2022 March 4th

# Formatting
toc: false
slide_level: 2
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
aspectratio: 43
section-titles: true
theme: metropolis

---

## Введение

На предыдущем этапе мы описали задачу проекта и определили основные формулы для ее решения. Рассмотрим более подробно алгоритм, который будем использовать для решения задачи и дальнейшего написания программы.

# Уравнения молекулярной динамики

## Потенциал взаимодействия

Влияние молекул друг на друга описывается потенциалом взаимодействия U.

Мы будем рассматривать простейший случай - парное взаимодействие:

$$U_{ij} = U(r_{ij}),$$
где $$r_{ij} = |r_i - r_j|$$

Суммарная потенциальная энергия равна:

$$E_p = \sum_{i<j}{U_{ij}}$$

## Движение чатиц

Сила, действующая на данную молекулу:

$$F_i = -\frac{\partial E_p}{\partial r_i}$$

Движение частиц описывается вторым законом Ньютона:

$$m_i\frac{d^2r_i}{dt^2} = F_i$$

## Получение уравнений

Получим систему $N$ обыкновенных дифференциальных уравнений второго порядка и перепишем ее в виде $2N$ уравнений первого порядка:

$$\frac{dr_i}{dt} = v_i,$$
$$\frac{dv_i}{dt} = a_i.$$

где $v_i$ - скорость частиц, $a_i = \frac{F_i}{m_i}$ - ускорение частиц.

# Определение условий

## Начальные условия

Дополним полученную систему начальными условиями:

$$r_i(t = 0) = r_{i0}, v_i(t = 0) = v_{i0}$$

Необходимо оптимизировать расчет сил взаимодействия. Вдвое увеличить скорость можно, учитывая третий закон Ньютона:

$$F_{ij} = -F_{ji}$$

## Граничные условия

Граничные условия зададим периодически:

$$\text{если } |\Delta x| > \frac{L}{2}, \Delta x = \Delta x - sgn(\Delta x) \cdot L$$

# Алгоритм Верле

Будем использовать алгоритм Верле в скоростной форме:

$$r_i^{n+1} = r_i^n + v_i^n \cdot \Delta t + a_i^n \cdot \frac{\Delta t^2}{2},$$

$$v_i^{n+1} = v_i^n + \frac{1}{2} (a_i^n + a_i^{n+1}) \Delta t.$$

## Алгоритм Верле

Перепишем схему алгоритма для удобства использования:

$$v^{n + 1/2}_i = v^n_i + a^n_i \cdot \frac{\Delta t}{2},$$
$$r^{n + 1}_i = r^n_i + v^{n + 1/2}_i \cdot \Delta t,$$
$$v^{n + 1}_i = v^{n + 1/2}_i + a^{n + 1}_i \cdot \frac{\Delta t}{2}.$$

## Выбор шага по времени

В качестве критерия выбора шага по времени будем использовать условие сохранения полной энергии системы:

$$E = \sum_1\frac{m_iv_i^2}{2} + \sum_{i<j} U_{ij}$$

# Потенциал Леннард-Джонса

Потенциал описывает парное взаимодействие молекул. Для удобства запишем его в следующем виде:

$$U_{LJ} = \varepsilon ((\frac{b}{r})^{12} - 2(\frac{b}{r})^6))$$

# Интегрирование уравнений движения

Для завершения алгоритма проведем интегрирование уравнений движения в цикле по времени.

# Выводы

Мы описали алгоритм для решения задачи.

Основные шаги алгоритма:

- Определение начальных условий
- Определение граничных условий
- Расчет значений ускорений частиц
- Выбор шага по времени
- Решение системы
